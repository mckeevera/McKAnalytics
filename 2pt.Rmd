```{r}
library(nflverse)
library(tidyverse)
library(ggrepel)
data <- load_pbp(2023)
```

```{r}
library(ggimage)
```

```{r}
data <- data %>% 
  filter(two_point_attempt == 1)
```

```{r}
data <- data %>%
  group_by(posteam) %>%
  summarise(n = n(),
            success = sum(yards_gained)/2)
```

```{r}
data <- data %>% 
  rename(team_abbr = posteam) %>%
  left_join(teams)
```

```{r}
#Making the plot
ggplot(data = data) +
  geom_col(mapping = aes(x = n, y = reorder(team_abbr, n), fill = team_color)) +
  scale_fill_identity() +
  geom_image(mapping = aes(x = n, y = reorder(team_abbr, n), image = team_logo_espn), size = 0.12) +
  theme_light() + 
  labs(
    x = "Number of Squids",
    y = "Player",
    title = "The 2023 Squid Leaders",
    subtitle = "2023 Regular Season | A 'Squid' consists of having 10+ tackles and assists in a game",
    caption = "Data from nflverse | Graphic by Alex McKeever"
 ) +
  theme(legend.position = "none")

```
